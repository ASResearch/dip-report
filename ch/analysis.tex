\section{性质分析}
\label{section:properties}
在介绍完开发者激励协议后，这一章我们具体分析在实际情况下可能出现的作弊情况以及DIP所具有的抗作弊性质。分别从用户和开发者的角度来看，存在的作弊行为主要包括收买用户，恶意分拆DApp，女巫攻击等等。%在实际运作中，我们可能根据实际情况对具体公式会有所调整，但这些性质仍能够保证大致满足。

\subsection{收买用户}
所谓收买是指DApp开发者通过各种手段例如贿赂用户从而获得用户的全部投票权，这种现象在现实生活中也非常普遍。这里我们假设所有正常用户都是利益最大化的。我们认为用户关心的是他心目中DApp在排行榜上所处的排名，而不关心DApp开发者最终会获得多少奖金。亦即，每个用户乐于最大限度的提升自己心目中优秀DApp的排名分（score值）。我们的二阶排名算法保证了下面这个特征：

\begin{property}
	\label{p1}
	在DIP模型中，对于一个利益最大化的用户，一般而言，他会将手中的票投给多个不同的DApp。
\end{property}
我们用如下模型来具体说明：

不失一般性，假设用户$a_i$对所有DApp的价值权重为$b_{i1},b_{i2},...,b_{in}$(可理解为用户对不同DApp的真实倾向)，采用公式\ref{eq:sqrt}的形式，则该用户最终分配的分贡献值满足
$$\frac{b_{i1}}{\sqrt{\nr_{i1}}}=\frac{b_{i2}}{\sqrt{\nr_{i2}}}=\cdots=\frac{b_{in}}{\sqrt{\nr_{in}}}$$
即对于用户$a_i$而言，其贡献值分配策略会与其对DApp的真实评价相符，具体证明见附录\ref{subsection:proof1}。

传统投票统计模型中常常使用更常见的线性排名分算法，即
$$g(\nr_{1j},\nr_{2j},...,\nr_{mj}) = \sum_{i=1}^m \nr_{ij}$$
在这种模型下，理性用户则只会将所有票投给自己最喜爱的DApp。相比之下，公式\ref{eq:sqrt}更能促进用户和DApp之间的交互，其根本原因在于根号函数的特性，即用户把票投给多个DApp才能最大化利用其投票效用，在论文\cite{buterin2018liberal}中也有类似的分析。综上，用户会倾向于投给多个DApp的同时保证自己最喜欢DApp的领先性，即上面的比例等式。

在实际生活中，传统线性投票模型通常会限制用户为单个目标投票的最大票数，从而强制让用户投给多个目标。而我们的算法则通过激励从本质上达到同样的目的，并且具有更加简洁优美的数学表达形式。

同时，基于上述特性，我们可以得出关于DIP具有抗收买特性的推论：
\begin{corollary}
被收买的用户对DApp排名分的总贡献远远小于正常的用户。
\end{corollary}
对于已经被收买的用户$a_i$，最多给收买其的DApp开发者贡献$\sqrt{\nr_i}$效用值。而一个正常未被收买的用户，假设其期望投票$K$个DApp($K>1$)而不是被收买只投票给某一个DApp\footnote{$K$反应的是该用户给出具有区分度的投票的DApp数目，通常是大于1的，只要该用户对DApp价值权重分布不是太极端，即只喜欢某个特定的DApp而对其他DApp打分都趋近于0。}，在其对这些DApp的价值权重是分布较为均匀的情况下，用户$a_i$给所有DApp带来的总排名分提升大约在$O(\sqrt{K\nr_i})$这个级别，即，未被收买用户起到的作用是被收买用户的$O(\sqrt{K})$倍，这样就一定程度上提高了开发者收买用户的代价。

\subsection{恶意分拆}
%（增加开发者开发多个正常DApp的讨论？）

对于开发者而言，另一种作弊行为就是恶意分拆。所谓恶意分拆是指DApp开发者将自己的DApp强行分拆成若干个DApp以获得所有分拆的DApp的总奖励。直觉上，这种分拆会增加参与激励的候选DApp数量进而增加总奖励。我们认为DApp开发者关心的是最终获得的总奖金。同时也有一定的高排名带来隐性收益。

作为最终的奖励分配策略，公式\ref{eq:distribution}的凹函数性能保证如下特性：
\begin{property}
	在所有投票者均为正常用户的情况下，开发者通过DApp分拆不会提升他的收益。
\end{property}
这里假设正常用户存在下列两种情形：其一用户面对DApp分拆选择简单的把原本投给分拆前DApp的票分散开来（分给拆分后的DApp），这种行为一般表现为同一个应用拥有不同的智能合约调用地址；其二，假设拆分之前用户对该DApp的价值权重为$c$，对两个拆分之后的DApp的价值权重分别为$a$和$b$，可以得出$c \geq a+b$。这个可以理解为DApp拆分之后两者的质量将大幅下降且缺乏联动性，导致两者的质量和比原DApp还要差。在这两类情况下，开发者不会提升其收益，具体证明见附录\ref{subsection:proof2}。

进一步地，开发者还可采取的作弊手段为同时进行DApp分拆和收买，例如，先分拆成$K$个DApp，然后让被收买的用户均匀的将票投在自己拆分的$K$个DApp上以实现效用最大化。我们有下面的推论：
\begin{corollary}
	即使引入被收买者的情况下，开发者进行DApp分拆不会提升他的收益。
\end{corollary}
具体证明见附录\ref{subsection:proof3}。

值得注意的是，开发者将DApp进行拆分同时也会降低在排行榜上的排名，从而减少排名带来的隐形收益。综上所述，我们的算法能从本质上防止DApp分拆的进攻手段。

当然对于开发了多个不同DApp的开发者，多个应用之间并不存在拆分或镜像关系，因此其收益不受影响。

\subsection{女巫攻击}
广义上的女巫攻击(Sybil Attack)是指攻击者通过创建大量假名标识来破坏对等网络的信誉系统，使用其获得虚假的高重要性评分\cite{quercia2010sybil}。在星云黄皮书中，已经分析了星云指数对通过创建大量账户提升星云指数这类作弊行为具有良好的抵抗性\cite{Nabulasyellowpaper}。因此在DIP的投票模型下，用户无法通过创建大量账户来获取更高的NR值，即%按照公式\ref{eq:vote_rate}定义进而也无法获取更高的投票效用。即，
$$\mathcal{C}(c)>\mathcal{C}(a)+\mathcal{C}(b)$$

其中$c$为原账户，$a$,$b$为拆分后子账户。按照公式\ref{eq:vote_rate}定义进而其投票效用也满足如下约束，
$$\sqrt{\nr_{a+b}}>\sqrt{\nr_a}+\sqrt{\nr_b}$$

%所谓女巫攻击是指一个原本高NR的用户将自己的财产转移到多个新账户里，然后多个账户作为被收买的新用户统一给某个DApp投票。
%￥解决这个问题的主要手段是利用NR本身的抗作弊性质。假设进行女巫攻击的用户原NR值为$\nr_{a+b}$, 进行财产拆分之后两个新用户的NR值分别为$\nr_a$与$\nr_b$。由于我们只需要考虑该用户给同一个DApp投票，故我们只需比较$\sqrt{\nr_{a+b}}$与$\sqrt{\nr_a}+\sqrt{\nr_b}$的大小。若能满足
%\begin{align}
%\label{sybil}
%\sqrt{\nr_{a+b}}>\sqrt{\nr_a}+\sqrt{\nr_b}
%\end{align}
%则以此类推可得到将NR值拆分成多个用户投票效用也不会增加。

\textcolor{red}{待补充}
%我们可通过下面三种方案来实现这个目标：

%\begin{itemize}
%	\item 通过调整NR本身的参数使得在一定范围内满足(\ref{sybil})。虽然在$\nr_a,\nr_b$均趋于无穷时有$\nr_{a+b}=\nr_a+\nr_b$，与(\ref{sybil})矛盾，但因为用于女巫攻击的新用户NR值都较低，故我们只需在$\nr_a,\nr_b$时都很低时(\ref{sybil})成立即可，而这是NR通过调参所能达到的。
	
%	\item 通过对所有参与投票的用户的NR值进行预处理，一个简单的方案为将所有NR值直接平方。那么(\ref{sybil})可根据黄皮书\cite{Nabulasyellowpaper}里Wilbur函数的性质$f(x_1+x_2)>f(x_1)+f(x_2)$直接得到。值得一提的是，将NR进行平方的预处理仅仅用在DIP中，而对NR的其他应用均不作处理，进而也不会损害NR本身的性质。
	
%	\item 通过只取NR排名前$L$或$L\%$的用户。这样拆分成多个小NR用户可能无法达到排名要求从而增加女巫攻击的代价。而这也是白皮书\cite{Nabulaswhitepaper}里所采取的方法。
%\end{itemize}
%我们认为，通过上述三种方案的结合使用能够有效防止女巫攻击。